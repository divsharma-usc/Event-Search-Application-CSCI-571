<div id = "outterBox">
    <!-- SEARCH FORM CONTAINER -->
    <div id="search_form_container">

        <div id = "search_form_heading">
            <span>Events Search</span>
        </div>

        <div id="search_form_container_line"></div>

        <form class="form" id="search_events_form" method="post"  autocomplete="off" [formGroup]="searchEventsForm">              
            <label style="display: block;" class="required-field" >Keyword</label>
            <input type="text"
                    placeholder=""
                    matInput
                    formControlName="keyword"
                    [matAutocomplete]="auto"
                    class = "keywordInput"
                    id = "keywordID"
                    required>
            <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
            <mat-option *ngIf="isLoading" class="is-loading"><mat-spinner class="mat-spinner-css" style="height: 30px; width:30px;"></mat-spinner></mat-option>
            <ng-container *ngIf="!isLoading">
                <mat-option *ngFor="let event of filteredEvents" [value]="event">
                    <span>{{event}}</span>
                </mat-option>
            </ng-container>
            </mat-autocomplete>
               

            <div id="distance_and_category_box" style="margin-top: 8px;">

                <div id="distance">
                    <label style="display: block;" class="required-field">Distance (miles)</label>
                    <input style="display: block; margin-top: 6px;" type="number" placeholder="10" id="distance" min="1" formControlName="distance"/>
                </div>

                <div id ="category_box">
                    <label style="display: block;" class="required-field">Category</label>
                    <select id="segment" formControlName="segment">
                        <option *ngFor="let s of segments" [ngValue]="s">{{ s }}</option>
                    </select>
                </div>
            </div>

            <div class="location_box"  style="margin-top: 8px;">
          
                <label class="required-field" style="margin-top: 0px;">Location</label>
                <input type="text" id="locationID" formControlName="location" required/>
                <div id="checkboxBox">
                    <input type="checkbox" id="autoDetectID" name="auto_detect_location" formControlName="autoDetection"><label>Auto-Detect Location</label>
                </div>
            
            </div>

            <div id = "search_form_buttons_box">
                <button id="submit_search_form" class="btn btn-danger" (click)="submitSearchForm()">SEARCH</button>
                <button id="clear_search_form" (click)="clearSearchForm()" class="btn btn-primary">CLEAR</button>
            </div>

        </form>
    </div>

    <!-- TABLE -->
    <table class="table table-striped table-dark" *ngIf="showTable">
        <thead>
            <tr class="table-dark">
                <th scope="col" class="table-dark">Date/Time</th>
                <th scope="col" class="table-dark">Icon</th>
                <th scope="col" class="table-dark">Event</th>
                <th scope="col" class="table-dark">Genre</th>
                <th scope="col" class="table-dark">Venue</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let event of eventsInformation;">
                <td scope="row" class="table-dark">{{event.date}} <br> {{event.time}}</td>
                <td class="table-dark">
                    <img
                        [src]="event.imageSrc"
                        class="me-2"
                        style="width: 50px; height: 50px;"
                    />
                </td>
                <td class="table-dark" (click)="showEventDetails(event.id)" class="pointer">{{event.name}}</td>
                <td class="table-dark">{{event.genre}}</td>
                <td class="table-dark">{{event.venue}}</td>
            </tr>
        </tbody>
    </table>

    <!-- Event Details -->
    <div *ngIf="showDetails" id="showEventDetails">
        <button (click)="back()" class="back-button">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
            </svg>Back</button>
        <div id="eventNameHeading">
            <p>{{eventDetails.eventName}}</p>
            <button ngClass="heart-button" (click)="addOrRemoveFromFavorites(eventDetails.id, eventDetails.eventDate, eventDetails.genres, eventDetails.venue, eventDetails.eventName)">
                <svg *ngIf="isIdNotInFavorites(eventDetails.id)" xmlns="http://www.w3.org/2000/svg" width="16" height="16"  class="bi bi-heart" viewBox="0 0 16 16">
                    <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                </svg>
                <svg *ngIf="isIdInFavorites(eventDetails.id)" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                </svg>
            </button>
        </div>
        <mat-tab-group [backgroundColor]="'primary'">
            <mat-tab label="Events">
                <div id="outterContainer">
                    <div id="leftContainer">
                        <label>Date</label>
                        <div>{{eventDetails.eventDate}}</div>
                        <label>Artist/Team</label>
                        <div>{{eventDetails.artistOrTeam}}</div>
                        <label>Venue</label>
                        <div>{{eventDetails.venue}}</div>
                        <label>Genres</label>
                        <div>{{eventDetails.genres}}</div>
                        <label>Price Ranges</label>
                        <div>{{eventDetails.priceRange}}</div>
                        <label>Ticket Status</label>
                        <div class="ticketStatus" *ngIf="eventDetails.ticketStatus=='onsale'" style="background-color: green;">On Sale</div>
                        <div class="ticketStatus" *ngIf="eventDetails.ticketStatus=='offsale'" style="background-color: red;">Sold Out</div>
                        <div class="ticketStatus" *ngIf="eventDetails.ticketStatus=='cancelled'" style="background-color: black;">Cancelled</div>
                        <div class="ticketStatus" *ngIf="eventDetails.ticketStatus=='rescheduled'" style="background-color: orange;">Rescheduled</div>
                        <div class="ticketStatus" *ngIf="eventDetails.ticketStatus=='postponed'" style="background-color: orange;">Postponed</div>
                        <label>Buy Ticket At:</label>
                        <div><a href="{{eventDetails.buyTicketAt}}" target="">Ticketmaster</a></div>
                    </div>
                    <div id="rightContainer">
                        <img [src]="eventDetails.seatMap">
                    </div>
                </div>
            </mat-tab>

            <mat-tab label="Artist/Teams"> Content 2 </mat-tab>
            <mat-tab label="Venue"> Content 3 </mat-tab>
        </mat-tab-group>
    </div>
</div>